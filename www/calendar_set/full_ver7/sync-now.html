<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Google Calendar ë™ê¸°í™”</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto; }
    h1 { color: #667eea; }
    button { padding: 15px 30px; font-size: 18px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; }
    button:hover { background: #5568d3; }
    #result { margin-top: 30px; padding: 20px; background: #f5f7fa; border-radius: 8px; }
    .loading { color: #667eea; }
    .success { color: #4caf50; }
    .error { color: #f44336; }
    pre { background: white; padding: 15px; border-radius: 5px; overflow-x: auto; }
  </style>
</head>
<body>
  <h1>ğŸ“… Google Calendar â†’ Supabase ë™ê¸°í™”</h1>
  <p>Google Calendarì˜ ëª¨ë“  ì´ë²¤íŠ¸ë¥¼ Supabaseë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤.</p>
  
  <button onclick="syncCalendar()">ğŸ”„ ì§€ê¸ˆ ë™ê¸°í™” ì‹œì‘</button>
  
  <div id="result"></div>
  
  <script>
    async function syncCalendar() {
      const result = document.getElementById('result');
      result.innerHTML = '<p class="loading">â³ ë™ê¸°í™” ì¤‘... (ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤)</p>';
      
      try {
        // Netlify Functions í˜¸ì¶œ
        const response = await fetch('/.netlify/functions/sync-calendar', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          }
        });
        
        const data = await response.json();
        
        if (response.ok) {
          let html = '<h2 class="success">âœ… ë™ê¸°í™” ì™„ë£Œ!</h2>';
          html += '<h3>ê²°ê³¼:</h3>';
          html += '<ul>';
          data.results.forEach(r => {
            html += `<li><strong>${r.room.toUpperCase()}í™€</strong>: ${r.count}ê°œ ì´ë²¤íŠ¸ ë™ê¸°í™”</li>`;
          });
          html += '</ul>';
          html += '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
          result.innerHTML = html;
        } else {
          result.innerHTML = `<h2 class="error">âŒ ì˜¤ë¥˜ ë°œìƒ</h2><p>${data.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}</p><pre>${JSON.stringify(data, null, 2)}</pre>`;
        }
      } catch (error) {
        result.innerHTML = `<h2 class="error">âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜</h2><p>${error.message}</p>`;
      }
    }
  </script>
</body>
</html>
